(function(n){var i,t=function(n,t){return function(){return n.apply(t,arguments)}},r,u,f;i=function(){function i(n,i){this.run=t(this.run,this);var r;r=i[0],this.metric=i[1],this.getVal=this.makeGetVal(n,r)}return i.prototype.run=function(){return this.verify(this.metric,this.getVal())},i.prototype.makeGetVal=function(t,i){var u,f,r;return r=t.attr("type"),r==="checkbox"?function(){return t.is(":checked")}:r==="radio"?(f=t.attr("name"),function(){return n('[name="'+f+'"]').filter(":checked").val()}):this.metric==="one-of"?(u=n(i),function(){return u.map(function(){return n.trim(this.value)}).get().join("")}):function(){return n.trim(t.val())}},i.prototype.verify=function(t,i){var r,e,u,f;if(!!(t&&t.constructor&&t.call&&t.apply))return t(i);if(t instanceof RegExp)return t.test(i);if(f=n.map(t.split(":"),n.trim),u=f[0],r=f[1],e=f[2],u==="same-as"&&n(r).length!==1)throw new Error("same-as selector must target one and only one element");if(!i&&u!=="presence"&&u!=="one-of")return!0;switch(u){case"presence":return!!i;case"one-of":return!!i;case"exact":return i===r;case"not":return i!==r;case"same-as":return i===n(r).val();case"min-num":return+i>=+r;case"max-num":return+i<=+r;case"between-num":return+i>=+r&&+i<=+e;case"min-length":return i.length>=+r;case"max-length":return i.length<=+r;case"exact-length":return i.length===+r;case"between":return i.length>=+r&&i.length<=+e;case"integer":return/^\s*\d+\s*$/.test(i);case"float":return/^[-+]?[0-9]+(\.[0-9]+)?$/.test(i);case"email":return this.email(i);default:throw new Error("I don't know "+u+", sorry.");}},i.prototype.email=function(n){var t;return t=/^([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22))*\x40([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d))*$/,t.test(n)},i}(),t=function(n,t){return function(){return n.apply(t,arguments)}},r=function(){function r(r,f,e){this.get=f,this.field=e,this.change_status=t(this.change_status,this),this.runCheck=t(this.runCheck,this),this.delayedCheck=t(this.delayedCheck,this),this.events=t(this.events,this),this.$el=n(r),this.delayId="",this.status=null,this.checker=new i(this.$el,this.field),this.msg=new u(this.$el,this.get,this.field),this.events()}return r.prototype.events=function(){if(this.$el.attr("type")==="radio")return n('[name="'+this.$el.attr("name")+'"]').on("change",this.runCheck);this.$el.on("change",this.runCheck);this.$el.on("blur",this.runCheck);if(this.field[1]==="one-of")n(window).on("nod-run-one-of",this.runCheck);if(this.get.delay)return this.$el.on("keyup",this.delayedCheck)},r.prototype.delayedCheck=function(){return clearTimeout(this.delayId),this.delayId=setTimeout(this.runCheck,this.get.delay)},r.prototype.runCheck=function(){return n.when(this.checker.run()).then(this.change_status)},r.prototype.change_status=function(status){var isCorrect;try{status=eval(status)}catch(_error){}if(isCorrect=!!status,this.status!==isCorrect)return this.status=isCorrect,this.msg.toggle(this.status),n(this).trigger("nod_toggle"),this.field[1]==="one-of"&&status?n(window).trigger("nod-run-one-of"):void 0},r}(),t=function(n,t){return function(){return n.apply(t,arguments)}},u=function(){function i(n,i,r){this.$el=n,this.get=i,this.createShowMsg=t(this.createShowMsg,this),this.toggle=t(this.toggle,this),this.createMsg=t(this.createMsg,this),this.$msg=this.createMsg(r[2]),this.showMsg=this.createShowMsg()}return i.prototype.createMsg=function(t){return n("<i/>",{title:t,"class":this.get.helpSpanDisplay+" "+this.get.errorClass+" icon-warning-sign",style:"padding-left: 3px; color: #B94A48; vertical-align: super; cursor: help;"})},i.prototype.toggle=function(n){return n?this.$msg.remove():(this.showMsg(),this.get.broadcastError)?this.broadcast():void 0},i.prototype.createShowMsg=function(){var t,n;return n=this.$el.attr("type"),n==="checkbox"||n==="radio"?function(){return this.$el.parent().append(this.$msg)}:(t=this.findPos(this.$el),function(){return t.after(this.$msg)})},i.prototype.findPos=function(n){return this.elHasClass("parent",n)?this.findPos(n.parent()):this.elHasClass("next",n)?this.findPos(n.next()):n},i.prototype.elHasClass=function(n,t){var u,i,f,r;for(r=this.get.errorPosClasses,i=0,f=r.length;i<f;i++)if(u=r[i],t[n](u).length)return!0;return!1},i.prototype.broadcast=function(){return n(window).trigger("nod_error_fired",{el:this.$el,msg:this.$msg.html()})},i}(),t=function(n,t){return function(){return n.apply(t,arguments)}},f=function(){function i(i,r,u){(this.form=i,this.formIsErrorFree=t(this.formIsErrorFree,this),this.submitForm=t(this.submitForm,this),this.toggleSubmitBtnText=t(this.toggleSubmitBtnText,this),this.toggleSubmitBtn=t(this.toggleSubmitBtn,this),this.toggleGroupClass=t(this.toggleGroupClass,this),this.toggle_status=t(this.toggle_status,this),this.massCheck=t(this.massCheck,this),this.listenForEnter=t(this.listenForEnter,this),this.events=t(this.events,this),this.createListeners=t(this.createListeners,this),r)&&(this.form[0].__nod=this,this.get=n.extend({delay:700,disableSubmitBtn:!0,helpSpanDisplay:"help-inline",groupClass:"error",submitBtnSelector:"[type=submit]",metricsSplitter:":",errorPosClasses:[".help-inline",".add-on","button",".input-append"],silentSubmit:!1,broadcastError:!1,errorClass:"nod_msg",groupSelector:".control-group"},u),this.listeners=this.createListeners(r),this.submit=this.form.find(this.get.submitBtnSelector),this.checkIfElementsExist(this.form,this.submit,this.get.disableSubmitBtn),this.events())}return i.prototype.createListeners=function(n){var o,t,f,i,u,s,h,e;for(f=[],i=0,s=n.length;i<s;i++)for(t=n[i],t.length!==3&&this["throw"]("field",t),e=this.form.find(t[0]),u=0,h=e.length;u<h;u++)o=e[u],f.push(new r(o,this.get,t));return f},i.prototype.events=function(){var r,t,u,i;for(i=this.listeners,t=0,u=i.length;t<u;t++){r=i[t];n(r).on("nod_toggle",this.toggle_status)}return this.submit.length?this.submit.on("click",this.massCheck):this.form.on("keyup",this.listenForEnter)},i.prototype.listenForEnter=function(n){if(n.keyCode===13)return this.massCheck()},i.prototype.massCheck=function(t){var r,f,i,e,u;for(t!=null&&t.preventDefault(),r=[],u=this.listeners,i=0,e=u.length;i<e;i++)f=u[i],r.push(f.runCheck());return this.toggleSubmitBtnText(),n.when.apply(n,r).then(this.submitForm).then(this.toggleSubmitBtnText)},i.prototype.toggle_status=function(n){return this.toggleGroupClass(n.target.$el.parents(this.get.groupSelector)),this.get.disableSubmitBtn?this.toggleSubmitBtn():void 0},i.prototype.toggleGroupClass=function(n){return n.find("."+this.get.errorClass).length?n.addClass(this.get.groupClass):n.removeClass(this.get.groupClass)},i.prototype.toggleSubmitBtn=function(){return this.formIsErrorFree()?this.submit.removeClass("disabled").removeAttr("disabled"):this.submit.addClass("disabled").attr("disabled","disabled")},i.prototype.toggleSubmitBtnText=function(){var n;return n=this.submit.attr("data-loading-text"),n?(this.submit.attr("data-loading-text",this.submit.html()),this.submit.html(n)):void 0},i.prototype.submitForm=function(){var t;if(this.formIsErrorFree())return this.get.silentSubmit?(t=n(this.form),t.trigger("silentSubmit",t.serialize())):this.form.submit()},i.prototype.formIsErrorFree=function(){return!n(this.listeners).filter(function(){return this.status===null&&this.runCheck(),!this.status}).length},i.prototype.checkIfElementsExist=function(n,t,i){return n.selector&&n.length||this["throw"]("form",n),!t.length&&i?this["throw"]("submit",t):void 0},i.prototype["throw"]=function(n,t){var i;switch(n){case"form":i="Couldn't find form: ";break;case"submit":i="Couldn't find submit button: ";break;case"field":i="Metrics for each field must have three parts: "}throw new Error(i+t);},i}(),n.fn.nod=function(n,t){return(n||t)?(new f(this,n,t),this):this[0].__nod}})(jQuery);
//@ sourceMappingURL=nod.min.js.map